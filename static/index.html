<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherRadar Pro (Alpha) - Live NEXRAD Weather Visualization</title>
    <title>NEXRAD Weather Radar Visualization</title>
    
    <!-- Mapbox GL JS -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    
    <!-- Favicon and meta tags -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå¶Ô∏è</text></svg>">
    <meta name="description" content="Live NEXRAD weather radar visualization with real-time precipitation data">
    <meta name="keywords" content="weather, radar, NEXRAD, precipitation, storms">
    <meta property="og:title" content="WeatherRadar Pro">
    <meta property="og:description" content="Live NEXRAD weather radar visualization">
    <meta property="og:type" content="website">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-cloud-rain"></i>
                <h1>WeatherRadar Pro <span style="font-size: 0.6em; opacity: 0.7;">(Alpha)</span></h1>
            </div>
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <p class="loading-text">Initializing radar systems...</p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-cloud-rain"></i>
                    <span class="logo-text">WeatherRadar Pro <small style="opacity: 0.6;">Alpha</small></span>
                </div>
            </div>
            
            <div class="header-center">
                <div class="location-display" id="locationDisplay">
                    <i class="fas fa-map-marker-alt"></i>
                    <span id="locationText">Select Location</span>
                </div>
            </div>
            
            <div class="header-right">
                <button class="header-btn" id="settingsBtn" title="Settings">
                    <i class="fas fa-cog"></i>
                </button>
                <button class="header-btn" id="fullscreenBtn" title="Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="header-btn" id="helpBtn" title="Help">
                    <i class="fas fa-question-circle"></i>
                </button>
            </div>
        </header>

        <!-- Map Container -->
        <div id="map" class="map-container"></div>

        <!-- Left Sidebar -->
        <aside class="sidebar sidebar-left" id="leftSidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-satellite-dish"></i> Radar Controls</h3>
                <button class="sidebar-toggle" id="leftSidebarToggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <div class="sidebar-content">
                <!-- NEXRAD Data Source -->
                <div class="control-section">
                    <h4><i class="fas fa-database"></i> Data Source</h4>
                    
                    <div class="control-group">
                        <label for="radarSite">Radar Site:</label>
                        <select id="radarSite" class="form-select">
                            <option value="">Select a radar site...</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="dataDate">Date:</label>
                        <input 
                            type="date" 
                            id="dataDate" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="control-group">
                        <label for="nexradUrl">Direct URL (Optional):</label>
                        <div class="input-group">
                            <input 
                                type="url" 
                                id="nexradUrl" 
                                class="form-input"
                                placeholder="Or enter direct NEXRAD file URL"
                            >
                            <button id="pasteUrlBtn" class="btn-icon" title="Paste URL">
                                <i class="fas fa-paste"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <button id="loadDataBtn" class="btn btn-primary btn-block">
                            <i class="fas fa-download"></i>
                            Load Radar Data
                        </button>
                        <button id="browseDataBtn" class="btn btn-secondary btn-block" style="margin-top: 0.5rem;">
                            <i class="fas fa-list"></i>
                            Browse Available Files
                        </button>
                    </div>
                </div>

                <!-- Radar Products -->
                <div class="control-section">
                    <h4><i class="fas fa-layer-group"></i> Radar Products</h4>
                    <div class="control-group">
                        <label for="radarProduct">Product Type:</label>
                        <select id="radarProduct" class="form-select">
                            <option value="N0B">Base Reflectivity (N0B)</option>
                            <option value="N0G">Base Reflectivity Legacy (N0G)</option>
                            <option value="N0Q">Base Reflectivity HR (N0Q)</option>
                            <option value="N0U">Base Velocity (N0U)</option>
                        </select>
                    </div>
                </div>

                <!-- Visualization Settings -->
                <div class="control-section">
                    <h4><i class="fas fa-eye"></i> Display Options</h4>
                    
                    <div class="control-group">
                        <label for="vizType">Visualization Type:</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="vizType" value="raster" checked>
                                <span class="radio-custom"></span>
                                <span class="radio-label">
                                    <i class="fas fa-image"></i> Raster Overlay
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="vizType" value="points">
                                <span class="radio-custom"></span>
                                <span class="radio-label">
                                    <i class="fas fa-circle"></i> Point Data
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="vizType" value="both">
                                <span class="radio-custom"></span>
                                <span class="radio-label">
                                    <i class="fas fa-layer-group"></i> Both
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label for="opacitySlider">
                            Opacity: <span id="opacityValue">70%</span>
                        </label>
                        <div class="slider-container">
                            <input 
                                type="range" 
                                id="opacitySlider" 
                                class="slider"
                                min="0" 
                                max="100" 
                                value="70"
                            >
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="checkbox-group">
                            <label class="checkbox-option">
                                <input type="checkbox" id="showAnimation" checked>
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Enable Animation</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="showLabels" checked>
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Show Labels</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Map Layers -->
                <div class="control-section">
                    <h4><i class="fas fa-map"></i> Map Layers</h4>
                    <div class="control-group">
                        <div class="checkbox-group">
                            <label class="checkbox-option">
                                <input type="checkbox" id="showCounties" checked>
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Counties</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="showHighways">
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Highways</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="showCities" checked>
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Cities</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Right Sidebar -->
        <aside class="sidebar sidebar-right" id="rightSidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-chart-bar"></i> Data Info</h3>
                <button class="sidebar-toggle" id="rightSidebarToggle">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="sidebar-content">
                <!-- Data Status -->
                <div class="control-section">
                    <h4><i class="fas fa-info-circle"></i> Status</h4>
                    <div id="statusDisplay" class="status-display">
                        <div class="status-item">
                            <span class="status-label">Status:</span>
                            <span class="status-value" id="dataStatus">Ready</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Last Updated:</span>
                            <span class="status-value" id="lastUpdated">--</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Data Points:</span>
                            <span class="status-value" id="dataPoints">0</span>
                        </div>
                    </div>
                </div>

                <!-- Reflectivity Legend -->
                <div class="control-section">
                    <h4><i class="fas fa-palette"></i> Reflectivity Scale</h4>
                    <div class="legend-container">
                        <div class="legend-item">
                            <div class="legend-color" style="background: #40E0FF;"></div>
                            <span class="legend-text">Light (-10 to 5 dBZ)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #00FF00;"></div>
                            <span class="legend-text">Moderate (5 to 20 dBZ)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #FFFF00;"></div>
                            <span class="legend-text">Heavy (20 to 35 dBZ)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #FFA500;"></div>
                            <span class="legend-text">Very Heavy (35 to 50 dBZ)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #FF0000;"></div>
                            <span class="legend-text">Extreme (50 to 65 dBZ)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #FF00FF;"></div>
                            <span class="legend-text">Exceptional (65+ dBZ)</span>
                        </div>
                    </div>
                </div>

                <!-- Current Location Weather -->
                <div class="control-section">
                    <h4><i class="fas fa-crosshairs"></i> Location Data</h4>
                    <div id="locationWeather" class="weather-info">
                        <div class="weather-item">
                            <span class="weather-label">Coordinates:</span>
                            <span class="weather-value" id="currentCoords">--</span>
                        </div>
                        <div class="weather-item">
                            <span class="weather-label">Reflectivity:</span>
                            <span class="weather-value" id="currentReflectivity">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Bottom Panel -->
        <div class="bottom-panel" id="bottomPanel">
            <div class="panel-header">
                <h4><i class="fas fa-clock"></i> Timeline Controls</h4>
                <button class="panel-toggle" id="bottomPanelToggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="panel-content">
                <div class="timeline-controls">
                    <button class="timeline-btn" id="playBtn" title="Play Animation">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="timeline-btn" id="pauseBtn" title="Pause" style="display: none;">
                        <i class="fas fa-pause"></i>
                    </button>
                    <button class="timeline-btn" id="prevBtn" title="Previous Frame">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="timeline-btn" id="nextBtn" title="Next Frame">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <div class="timeline-slider-container">
                        <input type="range" id="timelineSlider" class="timeline-slider" min="0" max="0" value="0">
                        <div class="timeline-labels">
                            <span id="timelineStart">--:--</span>
                            <span id="timelineCurrent">Current</span>
                            <span id="timelineEnd">--:--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Action Buttons -->
        <div class="fab-container">
            <button class="fab" id="locationBtn" title="Go to My Location">
                <i class="fas fa-location-arrow"></i>
            </button>
            <button class="fab" id="refreshBtn" title="Refresh Data">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <!-- Modals -->
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Settings</h3>
                <button class="modal-close" id="settingsModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>Display Preferences</h4>
                    <div class="setting-item">
                        <label>Theme:</label>
                        <select id="themeSelect" class="form-select">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                            <option value="auto">Auto</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>Units:</label>
                        <select id="unitsSelect" class="form-select">
                            <option value="imperial">Imperial (¬∞F, mph)</option>
                            <option value="metric">Metric (¬∞C, km/h)</option>
                        </select>
                    </div>
                </div>
                <div class="settings-section">
                    <h4>Data Settings</h4>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="autoRefresh" checked>
                            Auto-refresh data (5 min)
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="showAlerts" checked>
                            Show weather alerts
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> Help & Information</h3>
                <button class="modal-close" id="helpModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h4>üß™ Alpha Testing Notice</h4>
                    <p><strong>This is an alpha version</strong> of WeatherRadar Pro. Some features may not work as expected. Please report any issues or feedback.</p>
                    <p><strong>Data Source:</strong> NEXRAD Level 3 data is fetched from NOAA's AWS S3 bucket using the pattern: <code>XXX_N0B_YYYY_MM_DD</code> where XXX is the radar site code.</p>
                </div>
                <div class="help-section">
                    <h4>About NEXRAD Data</h4>
                    <p>NEXRAD (Next Generation Radar) is a network of 160 Doppler weather radars operated by the National Weather Service. This application visualizes Level 3 NEXRAD data products.</p>
                </div>
                <div class="help-section">
                    <h4>How to Use</h4>
                    <ol>
                        <li>Select a radar site from the dropdown (e.g., FDR for Frederick, OK)</li>
                        <li>Choose a date (defaults to today)</li>
                        <li>Click "Load Radar Data" or "Browse Available Files"</li>
                        <li>Adjust visualization settings in the left panel</li>
                        <li>Use the timeline controls to animate data (when available)</li>
                    </ol>
                </div>
                <div class="help-section">
                    <h4>Alpha Testing Features</h4>
                    <ul>
                        <li><strong>Radar Site Selection:</strong> Choose from 160+ NEXRAD sites</li>
                        <li><strong>Date Selection:</strong> Browse data by date</li>
                        <li><strong>Browse Files:</strong> Get S3 URLs for manual file selection</li>
                        <li><strong>Direct URLs:</strong> Enter specific NEXRAD file URLs</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h4>Keyboard Shortcuts</h4>
                    <ul>
                        <li><kbd>Space</kbd> - Play/Pause animation</li>
                        <li><kbd>‚Üê/‚Üí</kbd> - Previous/Next frame</li>
                        <li><kbd>F</kbd> - Toggle fullscreen</li>
                        <li><kbd>L</kbd> - Go to current location</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
=======
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: white;
        }
        
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
        
        .controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            min-width: 250px;
            backdrop-filter: blur(10px);
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group:last-child {
            margin-bottom: 0;
        }
        
        .control-label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .control-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #444;
            border-radius: 4px;
            background: #333;
            color: white;
            font-size: 14px;
        }
        
        .control-input:focus {
            outline: none;
            border-color: #0078d4;
        }
        
        .btn {
            background: #0078d4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        .btn:hover {
            background: #106ebe;
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .status.success {
            background: rgba(0, 128, 0, 0.2);
            border: 1px solid #008000;
        }
        
        .status.error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid #ff0000;
        }
        
        .status.loading {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid #ffa500;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .legend-title {
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 20px;
            height: 15px;
            margin-right: 8px;
            border-radius: 2px;
        }
        
        .info-panel {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            max-width: 300px;
        }
        
        .info-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .info-item {
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .controls {
                left: 5px;
                right: 5px;
                top: 5px;
                min-width: auto;
                width: auto;
            }
            
            .info-panel {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="controls">
        <div class="control-group">
            <label class="control-label">NEXRAD File URL:</label>
            <input 
                type="url" 
                id="nexradUrl" 
                class="control-input"
                value="https://unidata-nexrad-level3.s3.amazonaws.com/FDR_N0B_2025_08_17_22_05_15"
                placeholder="Enter NEXRAD Level 3 file URL"
            >
        </div>
        
        <div class="control-group">
            <button id="loadData" class="btn">Load NEXRAD Data</button>
        </div>
        
        <div class="control-group">
            <label class="control-label">Visualization Type:</label>
            <select id="vizType" class="control-input">
                <option value="raster">Raster Overlay</option>
                <option value="points">Point Data</option>
                <option value="both">Both</option>
            </select>
        </div>
        
        <div class="control-group">
            <label class="control-label">Opacity:</label>
            <input 
                type="range" 
                id="opacity" 
                class="control-input"
                min="0" 
                max="1" 
                step="0.1" 
                value="0.7"
            >
        </div>
        
        <div id="status" class="status" style="display: none;"></div>
    </div>
    
    <div class="info-panel">
        <div class="info-title">NEXRAD Weather Radar</div>
        <div class="info-item">Real-time weather radar visualization using Mapbox GL JS and WebGL</div>
        <div class="info-item">Data: NOAA NEXRAD Level 3</div>
        <div class="info-item">Reflectivity values in dBZ</div>
    </div>
    
    <div class="legend">
        <div class="legend-title">Reflectivity (dBZ)</div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(64, 224, 255, 0.8);"></div>
            <span>Light (-10 to 5)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(0, 255, 0, 0.8);"></div>
            <span>Moderate (5 to 20)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(255, 255, 0, 0.8);"></div>
            <span>Heavy (20 to 35)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(255, 165, 0, 0.8);"></div>
            <span>Very Heavy (35 to 50)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(255, 0, 0, 0.8);"></div>
            <span>Extreme (50 to 65)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: rgba(255, 0, 255, 0.8);"></div>
            <span>Exceptional (65+)</span>
        </div>
    </div>

    <script src="nexrad-web.js"></script>
</body>
</html>